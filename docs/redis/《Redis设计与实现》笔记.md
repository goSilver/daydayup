## 一、字符串SDS
1. Redis只会用C字符串作为字面量，大多数情况下，Redis使用SDS作为字符串表示；
1. 比起C字符串，SDS具有以下优点：
   1. **常数复杂度获取字符串长度；**
   1. **杜绝缓冲区溢出；**
   1. **减少修改字符串长度所需要的内存重分配次数；**
   1. **二进制安全；**
   1. **兼容部分C字符串的函数。**



## 二、跳跃表

1. 跳跃表是有序集合的底层实现之一；
1. Redis中跳跃表实现由**zskiplist**和**zskiplistNode**两个结构组成，其中zskiplist保存跳跃表信息（比如表头结点、表尾节点、长度），zskiplistNode用于表示跳跃表节点；
1. 每个跳跃表节点的层高都是**1~32**之间的一个随机数，根据**幂次定律**，越大的数出现的概率越低；32层，最底层可以存2^64个节点，足够大；
1. 在同一个跳跃表中，多个节点可以包含相同的**score**值，但每个节点的成员对象必须是唯一的；
1. 跳跃表中的节点**按照score值排序**，当分值相同时，节点按照成员对象的大小进行排序；
1. 跳跃表支持**平均O(logN)，最坏O(N)**复杂度的节点查找，还可以通过顺序性操作来批量处理节点。



## 三、数据库

1. Redis服务器的所有数据库都保存在**redisServer.db**数组中，而数据库的数量则是由**redisServer.dbnum**属性保存，默认16；
1. 客户端通过修改目标数据库指针（_**SELECT**_命令），让它指向redisServer.db数组中的不同元素来切换不同的数据库；
1. 数据库主要由**dict**和**expires**两个字典构成，其中dict字典负责保存键值对，而expires字典则负责保存键的过期时间；
1. 因为数据库由字典构成，所以数据库的操作都是建立在字典操作之上；
1. 数据库的键总是一个字符串对象，而值则可以是任意一种Redis对象数据类型；
1. expires字典的键指向数据库中的某个键，而值记录了数据库键的过期时间；
1. Redis使用**惰性删除**和**定期删除**两种策略来删除过期的键；
1. 执行_**SAVE**_命令或者_**BGSAVE**_命令所产生的新RDB文件**不会**包含已经过期的键；
1. 执行_**BGREWRITEAOF**_命令所产生的重写AOF文件**不会**包含已经过期的键；
1. 当一个过期键被删除后，服务器会追加一条DEL命令到AOF文件的末尾，显示的删除过期键；
1. 当主服务器删除一个过期键之后，它会向所有从服务器发送一条DEL命令，显示的删除过期键；
1. 从服务器即使发现过期键也**不会**自作主张的删除它，而是等待主节点发来DEL命令，这种统一、中心化的策略可以保证主从服务器数据的一致；



## 四、RDB持久化

1. RDB文件用于保存和还原Redis服务器所有数据库中的所有键值对数据；
1. **_SAVE_**命令由服务器进程直接执行保存操作，所以该命令**会**阻塞服务器；
1. **_BGSAVE_**命令会fork()一个字进程执行保存操作，所以该命令**不会**阻塞服务器；
1. 服务器状态中会保存所有用save选项设置的保存条件（比如每隔1分钟，或者没执行1000条命令），当任意一个保存条件被满足时，服务器会自动执行BGSAVE命令；
1. RDB文件是一个经过压缩的**二进制文件**，由多个部分组成；
1. 对于不同类型的键值对，RDB文件会使用不同的方式来保存他们；



## 五、AOF持久化

1. AOF文件通过保存所有修改数据库的**写**命令请求来记录服务器的数据库状态；
1. AOF文件中的所有命令都以Redis命令请求协议的格式保存；
1. 命令请求会先保存到AOF缓冲区里面，之后再定期写入并同步AOF文件；
1. **appendfsync**选项的不同值对AOF持久化功能的安全性以及Redis服务器的性能有很大影响；
1. 服务器只要载入并重新执行保存在AOF文件中的命令，就可以还原数据库本来的状态；
1. AOF重写可以产生一个新的AOF文件，这个新的AOF文件和原有的AOF文件所保存的数据库状态一样，但体积更小；
1. AOF重写是一个有歧义的名字，该功能是通过读取数据库中的键值对来实现的，程序无需对现有AOF文件进行任何读入、分析或者写入操作；
1. 在执行BGREWRITEAOF命令时，Redis服务器会维护一个AOF重写缓冲区，该缓冲区会在子进程创建新的AOF文件期间，记录服务器所有执行的写命令。当子进程完成创建新的AOF文件的工作之后，服务器会将重写缓冲区中的所有内容追加到新AOF文件的末尾，使得新旧两个AOF文件所保存的数据库状态一致。最后，服务器用新的AOF文件替换旧的AOF文件，以此来完成AOF文件的重写操作；



## 六、复制


## 七、Sentinel


## 八、集群


## 九、事务






